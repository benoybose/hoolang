CMAKE_MINIMUM_REQUIRED(VERSION 3.16)
CMAKE_POLICY(SET CMP0074 NEW)
PROJECT(hoolang)

SET(CMAKE_VERBOSE_MAKEFILE ON)
MESSAGE("CMake Version: ${CMAKE_VERSION}")
SET(CMAKE_CXX_STANDARD 14)

IF(${CMAKE_COMPILER_IS_GNUCC} MATCHES 1)
    IF(${CMAKE_SIZEOF_VOID_P} MATCHES 8)
        SET(COMPILE_FLAGS "-m64")
        SET(LINK_FLAGS "-m64")        
    ELSE()
        SET(COMPILE_FLAGS "-m32")
        SET(LINK_FLAGS "-m32")
    ENDIF()
    SET(CMAKE_CXX_FLAGS "-static-libgcc -static-libstdc++")
ENDIF()

INCLUDE("${CMAKE_SOURCE_DIR}/packages/index.cmake")
SET(BOOST_ALL_DYN_LINK 1)

FIND_PACKAGE(Boost REQUIRED COMPONENTS
    filesystem 
    regex)
ADD_DEFINITIONS(-DBOOST_ALL_DYN_LINK)

FIND_PACKAGE(antlr4-runtime REQUIRED)
FIND_PACKAGE(antlr4-generator REQUIRED)
FIND_PACKAGE(Java REQUIRED)

ENABLE_TESTING()
ADD_SUBDIRECTORY(./hootest)
ADD_SUBDIRECTORY(./hoocommon)
ADD_SUBDIRECTORY(./hooast)
ADD_SUBDIRECTORY("${CMAKE_SOURCE_DIR}/hooparser")
# ADD_SUBDIRECTORY(./hoo)
# ADD_SUBDIRECTORY(./hooc)
